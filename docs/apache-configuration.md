# Apache Configuration for WordPress Permalinks

## Overview

WordPress sites generated by this tool use "pretty permalinks" (e.g., `/about/` instead of `/?page_id=6`). For these to work, Apache needs to be configured with:

1. **mod_rewrite** enabled
2. **AllowOverride All** for the web root directory

## Automatic Configuration

Run the provided script to automatically configure Apache:

```bash
./scripts/configure-apache.sh
```

This script will:
- Create a backup of your Apache configuration
- Enable `mod_rewrite` module
- Set `AllowOverride All` for `/opt/homebrew/var/www`
- Restart Apache

## Manual Configuration

If you prefer to configure manually:

### 1. Enable mod_rewrite

Edit `/opt/homebrew/etc/httpd/httpd.conf` and uncomment this line:

```apache
LoadModule rewrite_module lib/httpd/modules/mod_rewrite.so
```

### 2. Enable .htaccess support

Find the `<Directory "/opt/homebrew/var/www">` section and change:

```apache
AllowOverride None
```

to:

```apache
AllowOverride All
```

### 3. Restart Apache

```bash
brew services restart httpd
```

## Verification

Test that clean URLs work by accessing a page:

```bash
curl -s http://localhost:8080/your-site-name/about/ | grep "<title>"
```

You should see the page title, not a 404 error.

## Troubleshooting

### Pages return 404
- Verify mod_rewrite is enabled: `grep "^LoadModule rewrite_module" /opt/homebrew/etc/httpd/httpd.conf`
- Verify AllowOverride is set: `grep -A 20 '<Directory "/opt/homebrew/var/www">' /opt/homebrew/etc/httpd/httpd.conf | grep AllowOverride`
- Check that `.htaccess` exists in the site directory
- Restart Apache: `brew services restart httpd`

### .htaccess not being read
- Ensure AllowOverride is set to "All", not "None"
- Test by adding an invalid directive to `.htaccess` - you should get a 500 error

## Backup and Restore

The script creates automatic backups before making changes. To restore:

```bash
cp /opt/homebrew/etc/httpd/httpd.conf.backup-YYYYMMDD-HHMMSS /opt/homebrew/etc/httpd/httpd.conf
brew services restart httpd
```
